---
import BaseLayout from "@layouts/BaseLayout.astro";
import Services from "@lib/Reservation/Services/index.svelte";

import { arky, getBlockFromArray } from "@lib/index";
import { defaultLocale, getLocaleFromUrl, locales } from "@lib/i18n";

export function getStaticPaths() {
	return locales.map((locale) => ({
		params: {
			locale: locale === defaultLocale ? undefined : locale,
		},
		props: { locale },
	}));
}

const currLocale = getLocaleFromUrl(Astro.url);
const websiteCollection = await arky.cms.getCollection({ id: "website" });
const siteData = getBlockFromArray(websiteCollection, "info", currLocale);

// Extract strings (handle multilingual objects)
const siteTitle = typeof siteData.title === 'string' ? siteData.title : (siteData.title?.en || siteData.title?.[Object.keys(siteData.title || {})[0]] || 'Site');
const siteDescription = typeof siteData.description === 'string' ? siteData.description : (siteData.description?.en || siteData.description?.[Object.keys(siteData.description || {})[0]] || '');
---

<BaseLayout title={siteTitle} description={siteDescription}>
	<div class="container mx-auto px-4 pt-24 pb-8">
		<div class="text-center">
			<div class="inline-block px-4 py-2 bg-amber-100 text-amber-800 text-xs font-medium rounded-full">
				Preview Services
			</div>
		</div>
		<div class="flex justify-center">
			<Services client:load />
		</div>
	</div>
</BaseLayout>
